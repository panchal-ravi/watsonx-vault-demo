spec_version: v1
kind: connection
app_id: greetings
environments:
  draft:
    kind: oauth_auth_on_behalf_of_flow
    type: member
    server_url: https://login.microsoftonline.com/788d8595-3c0f-4d77-beda-ca1bb0715ede/oauth2/v2.0/token
    sso: true
    idp_config:
      header:
        content-type: application/x-www-form-urlencoded
      body:
        requested_token_use: on_behalf_of
        requested_token_type: urn:ietf:params:oauth:token-type:access_token
    app_config:
      header:
        content-type: application/x-www-form-urlencoded
  live:
    kind: oauth_auth_on_behalf_of_flow
    type: member
    server_url: https://login.microsoftonline.com/788d8595-3c0f-4d77-beda-ca1bb0715ede/oauth2/v2.0/token
    sso: true
    idp_config:
      header:
        content-type: application/x-www-form-urlencoded
      body:
        requested_token_use: on_behalf_of
        requested_token_type: urn:ietf:params:oauth:token-type:access_token
        client_id: 5c3790ba-90d7-48e0-ac13-b11cb6631913
        client_secret: 7TZ8Q~Ob3xYHwUXMFgZEKhuUD......
        scope: api://6a40d9e9-49b5-415b-91a8-67488d2eeff1/Products.Read
    app_config:
      header:
        content-type: application/x-www-form-urlencoded
      body:
        requested_token_use: on_behalf_of
        requested_token_type: urn:ietf:params:oauth:token-type:access_token
        client_id: 5c3790ba-90d7-48e0-ac13-b11cb6631913
        client_secret: 7TZ8Q~Ob3xYHwUXMFgZEKh....
        scope: api://6a40d9e9-49b5-415b-91a8-67488d2eeff1/Products.Read



# orchestrate connections set-credentials -a greetings \
# --env live \
# --token-url https://login.microsoftonline.com/788d8595-3c0f-4d77-beda-ca1bb0715ede/oauth2/v2.0/token \
# --client-id 5c3790ba-90d7-48e0-ac13-b11cb6631913 \
# --client-secret 7TZ8Q~Ob3xYHwUXMFgZEKhuUDCT..... \
# --scope api://6a40d9e9-49b5-415b-91a8-67488d2eeff1/Products.Read \
# --grant-type urn:ietf:params:oauth:grant-type:jwt-bearer




# ## set-identity-provider
# orchestrate connections set-identity-provider \
#   --app-id greetings \
#   --env live \
#   --url https://login.microsoftonline.com/788d8595-3c0f-4d77-beda-ca1bb0715ede/oauth2/v2.0/token \
#   --client-id 5c3790ba-90d7-48e0-ac13-b11cb6631913 \
#   --client-secret 7TZ8Q~Ob3xYHwUXMFgZEKhu..... \
#   --scope api://6a40d9e9-49b5-415b-91a8-67488d2eeff1/Products.Read \
#   --grant-type urn:ietf:params:oauth:grant-type:jwt-bearer